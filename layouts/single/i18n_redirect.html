
{{ define "content" }}
  {{ partial "post.html" . }}
  <style>
    .navigation, .footer, .fixed-bar{
      display: none;
    }
  </style>
  <script>
    ;(function () {
      // Only do i18n at root, 
      // // otherwise, redirect immediately
      // if (window.location.pathname !== '/') {
      //   window.location.replace('{{ .Permalink }}')
      //   return
      // }

      var getFirstBrowserLanguage = function () {
        var nav = window.navigator,
        browserLanguagePropertyKeys = ['language', 'browserLanguage', 'systemLanguage', 'userLanguage'],
        i,
        language

        if (Array.isArray(nav.languages)) {
          for (i = 0; i < nav.languages.length; i++) {
            language = nav.languages[i]
            if (language && language.length) {
              return language
            }
          }
        }

        // support for other well known properties in browsers
        for (i = 0; i < browserLanguagePropertyKeys.length; i++) {
          language = nav[browserLanguagePropertyKeys[i]]
          if (language && language.length) {
            return language
          }
        }
        return 'en'
      }

      var preferLang = getFirstBrowserLanguage()
      if (preferLang.indexOf('zh') !== -1) {
        console.log("preferLang:",preferLang)
        if (window.location.pathname.indexOf("_zh") !== -1){
          //ok 
        }else {
          var p = window.location.pathname

          if (p.charAt(p.length - 1) == '/') {
            p = p.substr(0, p.length - 1);
          }
          p += "_zh"
           window.location.pathname  = p 
        }
        // visitor prefers Chinese
        
      } else {
        if (window.location.pathname.indexOf("_zh") !== -1){
          //ok
          window.location.pathname  = window.location.pathname.replace("_zh","")
        }else {
          
        }
      }
    })()
  </script>
{{ end }}

